<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Matching for Causal Inference with Time-Dependent Treatments • MatchTime</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Matching for Causal Inference with Time-Dependent Treatments">
<meta name="description" content="Includes multiple methods to perform time-dependent matching with discrete and continuous time, allowing treatment and covariate changes at arbitrary case-specific timings. Among the included methods are balanced risk set matching, time-dependent propensity score matching, time-dependent prognostic score matching and time-dependent double score matching. Additionally includes various functions to create and transform start-stop data, because that is the required input for the matching. The package is designed specifically to handle very large datasets.">
<meta property="og:description" content="Includes multiple methods to perform time-dependent matching with discrete and continuous time, allowing treatment and covariate changes at arbitrary case-specific timings. Among the included methods are balanced risk set matching, time-dependent propensity score matching, time-dependent prognostic score matching and time-dependent double score matching. Additionally includes various functions to create and transform start-stop data, because that is the required input for the matching. The package is designed specifically to handle very large datasets.">
<meta property="og:image" content="https://robindenz1.github.io/MatchTime/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">MatchTime</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/creating_start_stop_data.html">Creating and Dealing with Start-Stop Data in R</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RobinDenz1/MatchTime/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="matchtime-">MatchTime <a class="anchor" aria-label="anchor" href="#matchtime-"></a>
</h1>
</div>
<p><code>MatchTime</code> is an R-Package which can be used to perform different sorts of time-dependent matching, which is also known as <em>sequential trial emulation</em>. In this type of matching, the treatment, outcome, and confounders are allowed to change over time. At each point in time where individuals switch from “untreated” to “treated”, controls which at this point in time are still “untreated” are matched to these individuals using standard matching methods. The point in time that this matching occurred is considered to be the “point of randomization” or “time-zero” for both cases and their matched controls. The result is a dataset that can be analyzed using standard time-to-event methods, such as simple Cox proportional-hazards regression models, even when complex forms of time-dependent confounding and treatment-confounder feedback are present in the data.</p>
<p>The package is designed to be as similar as possible to the excellent <code>MatchIt</code> package, and implements direct support for it when matching at each separate point in time. It supports treatment and covariate changes in discrete and continuous time by requiring the user to input <em>start-stop</em> data. Because generating and dealing with start-stop data can be difficult, it also implements various functions to make this easier for the user. Large parts of <code>MatchTime</code> were originally developed for the purpose of analyzing data from a large German health-insurance provider. As such, the functions are designed to be very fast and RAM efficient, relying almost entirely on the <code>data.table</code> package internally. Input datasets with ~ 20 million rows can be used in any function on a regular computer without any issues.</p>
<p>Note that this package is still in early phases of development. Large breaking changes may therefore occur without any warnings.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The developmental version may be installed from github using the <code>remotes</code> R-Package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org" class="external-link">remotes</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"RobinDenz1/MatchTime"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="bug-reports-and-feature-requests">Bug Reports and Feature Requests<a class="anchor" aria-label="anchor" href="#bug-reports-and-feature-requests"></a>
</h2>
<p>If you encounter any bugs or have any specific feature requests, please file an <a href="https://github.com/RobinDenz1/MatchTime/issues" class="external-link">Issue</a>.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>A small example for time-dependent matching on continuous start-stop data is given below, using the <code>heart</code> dataset from the <code>survival</code> package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RobinDenz1/MatchTime" class="external-link">MatchTime</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kosukeimai.github.io/MatchIt/" class="external-link">MatchIt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"heart"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/match_time.html">match_time</a></span><span class="op">(</span><span class="va">transplant</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">surgery</span>, data<span class="op">=</span><span class="va">heart</span>, id<span class="op">=</span><span class="st">"id"</span>,</span>
<span>                    match_method<span class="op">=</span><span class="st">"nearest"</span><span class="op">)</span></span></code></pre></div>
<p>As in <code>MatchIt</code>, balance statistics (at “baseline”) can be calculated using:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m_obj</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; match_time(formula = transplant ~ age + surgery, data = heart, </span></span>
<span><span class="co">#&gt;     id = "id", match_method = "nearest")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Summary of Balance for Matched Data at Baseline:</span></span>
<span><span class="co">#&gt;         Means Treated Means Control Std. Mean Diff. Var. Ratio  eCDF Mean</span></span>
<span><span class="co">#&gt; event       0.4745763     0.4883721              NA         NA 0.01379582</span></span>
<span><span class="co">#&gt; age        -2.5997517    -2.6059883              NA         NA 0.04105950</span></span>
<span><span class="co">#&gt; year        3.5534519     3.3669198              NA         NA 0.03444160</span></span>
<span><span class="co">#&gt; surgery     0.1864407     0.1162791              NA         NA 0.07016161</span></span>
<span><span class="co">#&gt;           eCDF Max</span></span>
<span><span class="co">#&gt; event   0.01379582</span></span>
<span><span class="co">#&gt; age     0.12105712</span></span>
<span><span class="co">#&gt; year    0.07416880</span></span>
<span><span class="co">#&gt; surgery 0.07016161</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample Sizes:</span></span>
<span><span class="co">#&gt;           Controls Treated All</span></span>
<span><span class="co">#&gt; Matched         51      51 102</span></span>
<span><span class="co">#&gt; Unmatched       17      18  35</span></span>
<span><span class="co">#&gt; Included       103      69 103</span></span>
<span><span class="co">#&gt; Supplied       103      69 103</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Points in Time:</span></span>
<span><span class="co">#&gt; Matching was performed at 43 unique points in time between 1 and 310.</span></span></code></pre></div>
<p>The actual number of cases and matched controls over time, as well as the number of potential controls at these points in time can additionally be visualized using:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m_obj</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example_plot-1.png" width="100%"></p>
<p>In this particular example, after around t = 45, there are no potential controls anymore, because no replacement was used and there are more cases than controls.</p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>Use <code>citation("MatchTime")</code> to get the relevant citation information.</p>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>© 2024 Robin Denz</p>
<p>The contents of this repository are distributed under the GNU General Public License. You can find the full text of this License in this github repository. Alternatively, see <a href="http://www.gnu.org/licenses/" class="external-link uri">http://www.gnu.org/licenses/</a>.</p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/RobinDenz1/MatchTime/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/RobinDenz1/MatchTime/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing MatchTime</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Robin Denz <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.repostatus.org/#wip" class="external-link"><img src="https://www.repostatus.org/badges/latest/wip.svg" alt="Project Status: WIP - Initial development is in progress, but there has not yet been a stable, usable release suitable for the public."></a></li>
<li><a href="https://cran.r-project.org/package=MatchTime" class="external-link"><img src="https://www.r-pkg.org/badges/version/MatchTime?color=green"></a></li>
<li><a href="https://cran.r-project.org/package=MatchTime" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/grand-total/MatchTime?color=blue"></a></li>
<li><a href="https://github.com/RobinDenz1/MatchTime/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/RobinDenz1/MatchTime/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/RobinDenz1/MatchTime" class="external-link"><img src="https://codecov.io/gh/RobinDenz1/MatchTime/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robin Denz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
